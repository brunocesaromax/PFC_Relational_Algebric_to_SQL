/* Operação Selecão */
SIGMA Dno = 4 ( EMPLOYEE )
SIGMA Salary > 30000 ( EMPLOYEE )
SIGMA ( Dno = 4 AND Salary > 25000 ) OR ( Dno = 5 AND Salary > 30000 ) ( EMPLOYEE )
SIGMA Dno = 4 AND Salary > 25000 ( EMPLOYEE )

/* Operação Projeção */
PI Lname, Fname, Salary (EMPLOYEE)
PI Sex, Salary (EMPLOYEE)
PI Fname, Lname, Salary (SIGMA Dno = 5 ( EMPLOYEE ))

/* Operação Renomeação */
DEP5_EMPS ATRIBUICAO SIGMA Dno = 5 ( EMPLOYEE )
RESULT ATRIBUICAO PI Fname, Lname, Salary ( DEP5_EMPS )
TEMP ATRIBUICAO SIGMA Dno = 5 ( EMPLOYEE )
R ( First_name, Last_name, Salary ) ATRIBUICAO PI Fname, Lname, Salary ( TEMP )

/* Operação com Teoria dos Conjuntos */
DEP5_EMPS ATRIBUICAO SIGMA Dno = 5 ( EMPLOYEE )
RESULT1 ATRIBUICAO PI Ssn ( DEP5_EMPS )
RESULT2 ( Ssn ) ATRIBUICAO PI Super_ssn ( DEP5_EMPS )
RESULT ATRIBUICAO RESULT1 UNIAO RESULT2

STUDENT UNIAO INSTRUCTOR
STUDENT INTERSECCAO INSTRUCTOR
STUDENT SUBTRACAO INSTRUCTOR
INSTRUCTOR SUBTRACAO STUDENT

/* Operação Produto Cartesiano */
FEMALE_EMPS ATRIBUICAO SIGMA Sex = 'F' ( EMPLOYEE )
EMPNAMES ATRIBUICAO PI Fname, Lname, Ssn ( FEMALE_EMPS )
EMP_DEPENDENTS ATRIBUICAO EMPNAMES PRODUTO_CARTESIANO DEPENDENT
ACTUAL_DEPENDENTS ATRIBUICAO SIGMA Ssn = Essn ( EMP_DEPENDENTS )
RESULT ATRIBUICAO PI Fname, Lname, Dependent_name ( ACTUAL_DEPENDENTS )

/* Operação Junção */
DEPT_MGR ATRIBUICAO DEPARTMENT JUNCAO Mgr_ssn = Ssn EMPLOYEE
RESULT ATRIBUICAO PI Dname, Lname, Fname ( DEPT_MGR )

EMP_DEPENDENTS ATRIBUICAO EMPNAMES PRODUTO_CARTESIANO DEPENDENT
ACTUAL_DEPENDENTS ATRIBUICAO SIGMA Ssn = Essn ( EMP_DEPENDENTS )
ACTUAL_DEPENDENTS ATRIBUICAO EMPNAMES JUNCAO Ssn = Essn DEPENDENT

/* Operação Junção natural */
PROJ_DEPT ATRIBUICAO PROJECT JUNCAO_NATURAL RHO ( Dname, Dnum, Mgr_ssn, Mgr_start_date ) ( DEPARTMENT )
DEPT ATRIBUICAO RHO ( Dname, Dnum, Mgr_ssn, Mgr_start_date ) ( DEPARTMENT )
PROJ_DEPT ATRIBUICAO PROJECT JUNCAO_NATURAL DEPT

DEPT_LOCS ATRIBUICAO DEPARTMENT JUNCAO_NATURAL DEPT_LOCATIONS

/* Operação Divisão */
SMITH ATRIBUICAO SIGMA Fname ='John' AND Lname ='Smith' ( EMPLOYEE )
SMITH_PNOS ATRIBUICAO PI Pno ( WORKS_ON JUNCAO Essn = Ssn SMITH )

SSN_PNOS ATRIBUICAO PI Essn, Pno ( WORKS_ON )
SSNS ( Ssn ) ATRIBUICAO SSN_PNOS DIVISAO SMITH_PNOS
RESULT ATRIBUICAO PI Fname, Lname ( SSNS JUNCAO_NATURAL EMPLOYEE )

(( PROJECT JUNCAO Dnum = Dnumber DEPARTMENT ) JUNCAO Mgr_ssn = Ssn EMPLOYEE ) /* Parei aqui*/

/* Consulta da seção 8.3.5 */
PI Pnumber, Dnum, Lname, Address, Bdate (((SIGMA Plocation ='Stafford' ( PROJECT )) JUNCAO Dnum = Dnumber ( DEPARTMENT )) JUNCAO Mgr_ssn = Ssn ( EMPLOYEE ))

/* Operação Projeção generalizada */
REPORT ATRIBUICAO RHO ( Ssn, Net_salary, Bonus, Tax ) (PI Ssn, Salary - Deduction , 2000 * Years_service , 0.25 * Salary ( EMPLOYEE ))

/* Operações de agregação e agrupamento */
RHO R( Dno, No_of_employees, Average_sal ) ( Dno FSCRIPT COUNT Ssn, AVERAGE Salary ( EMPLOYEE ))
Dno FSCRIPT COUNT Ssn, AVERAGE Salary (EMPLOYEE)
FSCRIPT COUNT Ssn, AVERAGE Salary (EMPLOYEE)

/* Operação de fechamento recursivo Seção 8.4.3 */
BORG_SSN ATRIBUICAO PI Ssn (SIGMA Fname ='James' AND Lname ='Borg' ( EMPLOYEE ))
SUPERVISION ( Ssn1 , Ssn2 ) ATRIBUICAO PI Ssn , Super_ssn ( EMPLOYEE )
RESULT1 ( Ssn ) ATRIBUICAO PI Ssn1 ( SUPERVISION JUNCAO Ssn2 = Ssn BORG_SSN)
RESULT2 ( Ssn ) ATRIBUICAO PI Ssn1 ( SUPERVISION JUNCAO Ssn2 = Ssn RESULT1 )
RESULT ATRIBUICAO RESULT2 UNIAO RESULT1

/* Operação Junção externa */
TEMP ATRIBUICAO ( EMPLOYEE JUNCAO_EXTERNA_ESQUERDA Ssn = Mgr_ssn DEPARTMENT )
RESULT ATRIBUICAO PI Fname , Minit , Lname , Dname ( TEMP )


/* Outros exemplos de consultas*/

/* Query 1*/
RESEARCH_DEPT ATRIBUICAO SIGMA Dname ='Research' ( DEPARTMENT )
RESEARCH_EMPS ATRIBUICAO ( RESEARCH_DEPT JUNCAO Dnumber = Dno EMPLOYEE )
RESULT ATRIBUICAO PI Fname , Lname , Address ( RESEARCH_EMPS )

PI Fname , Lname , Address (SIGMA Dname ='Research' ( DEPARTMENT JUNCAO Dnumber=Dno ( EMPLOYEE )))

/* Query 2*/
STAFFORD_PROJS ATRIBUICAO SIGMA Plocation ='Stafford' ( PROJECT )
CONTR_DEPTS ATRIBUICAO ( STAFFORD_PROJS JUNCAO Dnum = Dnumber DEPARTMENT )
PROJ_DEPT_MGRS ATRIBUICAO ( CONTR_DEPTS JUNCAO Mgr_ssn = SsnE MPLOYEE )
RESULT ATRIBUICAO PI Pnumber, Dnum, Lname, Address, Bdate ( PROJ_DEPT_MGRS )

/* Query 3*/
DEPT5_PROJS ATRIBUICAO RHO ( Pno ) (PI Pnumber (SIGMA Dnum = 5 ( PROJECT )))
EMP_PROJ ATRIBUICAO RHO ( Ssn , Pno ) (PI Essn , Pno ( WORKS_ON ))
RESULT_EMP_SSNS ATRIBUICAO EMP_PROJ DIVISAO DEPT5_PROJS
RESULT ATRIBUICAO PI Lname , Fname ( RESULT_EMP_SSNS JUNCAO_NATURAL EMPLOYEE )

/* Query 4*/
SMITHS ( Essn ) ATRIBUICAO PI Ssn (SIGMA Lname ='Smith' ( EMPLOYEE ))
SMITH_WORKER_PROJS ATRIBUICAO PI Pno ( WORKS_ON JUNCAO_NATURAL SMITHS )
MGRS ATRIBUICAO PI Lname , Dnumber ( EMPLOYEE JUNCAO Ssn = Mgr_ssn DEPARTMENT )
SMITH_MANAGED_DEPTS ( Dnum ) ATRIBUICAO PI Dnumber (SIGMA Lname ='Smith' ( MGRS ))
SMITH_MGR_PROJS ( Pno ) ATRIBUICAO PI Pnumber ( SMITH_MANAGED_DEPTS JUNCAO_NATURAL PROJECT )
RESULT ATRIBUICAO ( SMITH_WORKER_PROJS UNIAO SMITH_MGR_PROJS )

PI Pno ( WORKS_ON JUNCAO Essn=Ssn (PI Ssn (SIGMA Lname ='Smith' ( EMPLOYEE ))) UNIAO PI Pno ((PI Dnumber (SIGMA Lname ='Smith' (PI Lname , Dnumber ( EMPLOYEE ))) JUNCAO Ssn=Mgr_ssn DEPARTMENT )) JUNCAO Dnum_ber = Dnum PROJECT) /*Resolvido*/

/* Query 5*/
T1( Ssn, No_of_dependents ) ATRIBUICAO Essn FSCRIPT COUNT Dependent_name ( DEPENDENT )
T2 ATRIBUICAO SIGMA No_of_dependents>2 (T1)
RESULT ATRIBUICAO PI Lname , Fname (T2 JUNCAO_NATURAL EMPLOYEE )

/* Query 6*/
ALL_EMPS ATRIBUICAO PI Ssn ( EMPLOYEE )
EMPS_WITH_DEPS ( Ssn ) ATRIBUICAO PI Essn ( DEPENDENT )
EMPS_WITHOUT_DEPS ATRIBUICAO ( ALL_EMPS SUBTRACAO EMPS_WITH_DEPS )
RESULT ATRIBUICAO PI Lname , Fname ( EMPS_WITHOUT_DEPS JUNCAO_NATURAL EMPLOYEE )
 
PI Lname , Fname ((PI Ssn ( EMPLOYEE ) SUBTRACAO RHO Ssn (PI Essn ( DEPENDENT ))) JUNCAO_NATURAL EMPLOYEE ) /*Resolvido*/

/* Query 7*/
MGRS ( Ssn ) ATRIBUICAO PI Mgr_ssn ( DEPARTMENT )
EMPS_WITH_DEPS ( Ssn ) ATRIBUICAO PI Essn ( DEPENDENT )
MGRS_WITH_DEPS ATRIBUICAO ( MGRS INTERSECCAO EMPS_WITH_DEPS )
RESULT ATRIBUICAO PI Lname , Fname ( MGRS_WITH_DEPS JUNCAO_NATURAL EMPLOYEE )
