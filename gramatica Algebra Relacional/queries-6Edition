SIGMA Dnr=4 (FUNCIONARIO)
SIGMA Salario>30000 (FUNCIONARIO)
SIGMA (Dnr=4 AND Salario>25000) OR (Dnr=5 AND Salario>30000)(FUNCIONARIO)
SIGMA Dnr=4 (SIGMA Salario< 10000 (SIGMA idade > 18 (FUNCIONARIO)))
SIGMA Dnr=4 AND Salario>25000 (FUNCIONARIO)

PI Unome, Pnome, Salario (FUNCIONARIO)
PI Sexo, Salario (FUNCIONARIO)
PI Pnome, Unome, Salario (SIGMA Dnr=5 (FUNCIONARIO))

FUNCS_DEPT5 ASSIGNMENT SIGMA Dnr=5(FUNCIONARIO)
RESULTADO1 ASSIGNMENT PI Cpf(FUNCS_DEPT5)
RESULTADO2 ASSIGNMENT PI Cpf_supervisor(FUNCS_DEPT5)
RESULTADO ASSIGNMENT RESULTADO1 UNION RESULTADO2
RHO FUNCS_DEPT5 (SIGMA Dnr=5(FUNCIONARIO))

FUNC_MULHERES ASSIGNMENT SIGMA Sexo='F'(FUNCIONARIO)
FUNCNOMES ASSIGNMENT PI Pnome,Unome,Cpf(FUNC_MULHERES)
FUNC_DEPENDENTES ASSIGNMENT FUNCNOMES PRODUCT_CARTESIAN DEPENDENTE
DEPENDENTE_PARTIC ASSIGNMENT SIGMA Cpf=Fcpf(FUNC_DEPENDENTES)
DEPENDENTE_PARTIC ASSIGNMENT FUNCNOMES JOIN Cpf=Fcpf DEPENDENTE
RESULTADO ASSIGNMENT PI Pnome, Unome, Nome_dependente(DEPENDENTE_PARTIC)

DEP_GER ASSIGNMENT DEPARTAMENTO JOIN Cpf_gerente=Cpf FUNCIONARIO
RESULTADO ASSIGNMENT PI Dnome, Unome, Pnome (DEP_GER)

PROJETO_DEP ASSIGNMENT PROJETO NATURAL_JOIN RHO (Dnome, Dnum, Cpf_gerente, Data_inicio_gerente)(DEPARTAMENTO)
DEP ASSIGNMENT RHO(Dnome, Dnum, Cpf_gerente, Data_inicio_gerente)(DEPARTAMENTO)
PROJETO_DEP ASSIGNMENT PROJETO NATURAL_JOIN DEP
LOCAL_DEP ASSIGNMENT DEPARTAMENTO NATURAL_JOIN LOCALIZACAO_DEP

((PROJETO JOIN Dnum=Dnumero DEPARTAMENTO) JOIN Cpf_gerente=Cpf FUNCIONARIO)

SILVA ASSIGNMENT SIGMA Pnome='Joao' AND Unome='Silva' (FUNCIONARIO)
SILVA_PNRS ASSIGNMENT PI Pnr (TRABALHA_EM JOIN Fcpf=Cpf SILVA)
CPF_PNRS ASSIGNMENT PI Fcpf,Pnr (TRABALHA_EM)
CPFS ASSIGNMENT CPF_PNRS DIVISION SILVA_PNRS
RESULTADO ASSIGNMENT PI Pnome, Unome (CPFS NATURAL_JOIN FUNCIONARIO)

RELATORIO ASSIGNMENT RHO (Cpf, Salario_liquido, Bonus, Imposto) (PI Cpf, Salario - Deducao, 2000 * Anos_em_servico, 0.25 * Salario (FUNCIONARIO))

RHO R (Dnr, Nr_de_funcionarios, Media_sal) (Dnr FSCRIPT COUNT Cpf, AVERAGE Salario (FUNCIONARIO))

/* OPERACOES DE FECHAMENTO RECURSIVO */
CPF_BRITO ASSIGNMENT PI Cpf( SIGMA Pnome='Jorge' AND Unome='Brito' (FUNCIONARIO))
SUPERVISAO(Cpf1, Cpf2) ASSIGNMENT PI Cpf,Cpf_supervisor (FUNCIONARIO)
RESULTADO1(Cpf) ASSIGNMENT PI Cpf1 (SUPERVISAO JOIN Cpf2=Cpf CPF_BRITO)
RESULTADO2(Cpf) ASSIGNMENT PI Cpf1 (SUPERVISAO JOIN Cpf2=Cpf RESULTADO1)
RESULTADO ASSIGNMENT RESULTADO2 UNION RESULTADO1

/* OPERACOES DE JUNÇÃO EXTERNA */
TEMP ASSIGNMENT (FUNCIONARIO LEFT_OUTER_JOIN Cpf=Cpf_gerente DEPARTAMENTO)
RESULTADO ASSIGNMENT PI Pnome, Minicial, Unome, Dnome (TEMP)

/* EXEMPLOS DE CONSULTAS DA SEÇÃO 6.5  */

/*Consulta 1: Recuperar o nome e o endereço de todos os funcionários que trabalham para o departamento 'Pesquisa'*/
DEP_PESQUISA ASSIGNMENT SIGMA Dnome='Pesquisa' (DEPARTAMENTO)
FUNCS_PESQUISA ASSIGNMENT (DEP_PESQUISA JOIN Dnumero=Dnr FUNCIONARIO)
RESULTADO ASSIGNMENT PI Pnome,Unome,Endereco (FUNCS_PESQUISA)

/*Consulta 1 em uma única linha*/
PI Pnome,Unome,Endereco (SIGMA Dnome='Pesquisa' (DEPARTAMENTO JOIN Dnumero=Dnr (FUNCIONARIO)))

/*Consulta 2: Para cada projeto localizado em 'Mauá', liste o número do projeto, o número do departamento que o controla e o último nome, endereço e data de nascimento do gerente do departamento*/
PROJ_MAUA ASSIGNMENT SIGMA Projlocal='Mauá' (PROJETO)
DEP_CONTROLE ASSIGNMENT (PROJ_MAUA JOIN Dnum=Dnumero DEPARTAMENTO)
GER_DEP_PROJ ASSIGNMENT (DEP_CONTROLE JOIN Cpf_gerente=Cpf FUNCIONARIO)
RESULTADO ASSIGNMENT PI Projnumero, Dnum, Unome, Endereco, Datanasc (GER_DEP_PROJ)

/*Consulta 3: Descobrir os nomes dos funcionários que trabalham em todos os projeto controlados pelo departamento número 5.*/
PROJ_DEP5 ASSIGNMENT RHO(Pnr) (PI Projnumero (SIGMA Dnum=5 (PROJETO)))
FUNC_PROJ ASSIGNMENT RHO (Cpf, Pnr) (PI Fcpf, Pnr (TRABALHA_EM))
RESULTADO_CPF_FUNC ASSIGNMENT FUNC_PROJ DIVISION PROJ_DEP5 /* Atributos foram renomeados para serem utilizados na operação de divisão*/
RESULTADO ASSIGNMENT PI Unome, Pnome (RESULTADO_CPF_FUNC NATURAL_JOIN FUNCIONARIO)

/*Consulta 4: Fazer uma lista dos números de projeto para aqueles que envolvem um funcionário cujo último nome é 'Silva', seja como um trabalhador ou como um gerente do departamento que controla o projeto.*/
SILVA(Fcpf) ASSIGNMENT PI Cpf ( SIGMA Unome='Silva' (FUNCIONARIO))
PROJ_SILVA_TRAB ASSIGNMENT PI Pnr (TRABALHA_EM NATURAL_JOIN SILVA)
GERENTES ASSIGNMENT PI Unome, Dnumero ( FUNCIONARIO JOIN Cpf=Cpf_gerente DEPARTAMENTO)
DEPS_GERENCIADOS_SILVA(Dnum) ASSIGNMENT PI Dnumero ( SIGMA Unome='Silva' (GERENTES))
PROJS_SILVA_GER(Pnr) ASSIGNMENT PI Projnumero (DEPS_GERENCIADOS_SILVA NATURAL_JOIN PROJETO)
RESULTADO ASSIGNMENT (PROJ_SILVA_TRAB UNION PROJS_SILVA_GER)

/*Consulta 4 em uma única linha.*/
PI Pnr (TRABALHA_EM JOIN Fcpf=Cpf (PI Cpf (SIGMA Unome='Silva' (FUNCIONARIO))) UNION PI Pnr ((PI Dnumero (SIGMA Unome='Silva' (PI Unome,Dnumero (FUNCIONARIO))) JOIN Cpf=Cpf_gerente DEPARTAMENTO)) JOIN Dnumero=Dnum PROJETO)

/*Consulta 5: Listar os nomes de todos os funcionários com dois ou mais dependentes.*/
T1(Cpf,Nr_de_dependentes) ASSIGNMENT Fcpf FSCRIPT COUNT Nome_dependente (DEPENDENTE)
T2 ASSIGNMENT SIGMA Nr_de_dependentes>2 (T1)
RESULTADO ASSIGNMENT PI Unome, Pnome ( T2 NATURAL_JOIN FUNCIONARIO)

/*Consulta 6: Recuperar os nomes dos funcionários que não possuem dependentes. Exemplo de uso da operação SUBTRACTION*/
TODOS_FUNCS ASSIGNMENT PI Cpf (FUNCIONARIO)
FUNCS_COM_DEPEND(Cpf) ASSIGNMENT PI Fcpf (DEPENDENTE)
FUNCS_SEM_DEPEND ASSIGNMENT (TODOS_FUNCS SUBTRACTION FUNCS_COM_DEPEND)
RESULTADO ASSIGNMENT PI Unome, Pnome (FUNCS_SEM_DEPEND NATURAL_JOIN FUNCIONARIO)

/*Consulta 6 em apenas uma expressão */
PI Unome,Pnome ((PI Cpf (FUNCIONARIO) SUBTRACTION RHO Cpf (PI Fcpf (DEPENDENTE))) NATURAL_JOIN FUNCIONARIO)

/*Consulta 7: Listar os nomes dos gerentes que têm pelo menos um dependente.*/
GERS(Cpf) ASSIGNMENT PI Cpf_gerente(DEPARTAMENTO)
FUNCS_COM_DEPEND(Cpf) ASSIGNMENT PI Fcpf (DEPENDENTE)
GER_COM_DEPEND ASSIGNMENT ( GERS INTERSECTION FUNCS_COM_DEPEND)
RESULTADO ASSIGNMENT PI Unome, Pnome (GERS_COM_DEPEND NATURAL_JOIN FUNCIONARIO)



