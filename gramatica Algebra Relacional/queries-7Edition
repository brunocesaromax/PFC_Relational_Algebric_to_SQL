/* Operação Selecão */
SIGMA Dno = 4 ( EMPLOYEE )
SIGMA Salary > 30000 ( EMPLOYEE )
SIGMA ( Dno = 4 AND Salary > 25000 ) OR ( Dno = 5 AND Salary > 30000 ) ( EMPLOYEE )
SIGMA Dno = 4 AND Salary > 25000 ( EMPLOYEE )

/* Operação Projeção */
PI Lname, Fname, Salary (EMPLOYEE)
PI Sex, Salary (EMPLOYEE)
PI Fname, Lname, Salary (SIGMA Dno = 5 ( EMPLOYEE ))

/* Operação Renomeação */
DEP5_EMPS ASSIGNMENT SIGMA Dno = 5 ( EMPLOYEE )
RESULT ASSIGNMENT PI Fname, Lname, Salary ( DEP5_EMPS )
TEMP ASSIGNMENT SIGMA Dno = 5 ( EMPLOYEE )
R ( First_name, Last_name, Salary ) ASSIGNMENT PI Fname, Lname, Salary ( TEMP )

/* Operação com Teoria dos Conjuntos */
DEP5_EMPS ASSIGNMENT SIGMA Dno = 5 ( EMPLOYEE )
RESULT1 ASSIGNMENT PI Ssn ( DEP5_EMPS )
RESULT2 ( Ssn ) ASSIGNMENT PI Super_ssn ( DEP5_EMPS )
RESULT ASSIGNMENT RESULT1 UNION RESULT2

STUDENT UNION INSTRUCTOR
STUDENT INTERSECTION INSTRUCTOR
STUDENT SUBTRACTION INSTRUCTOR
INSTRUCTOR SUBTRACTION STUDENT

/* Operação Produto Cartesiano */
FEMALE_EMPS ASSIGNMENT SIGMA Sex = 'F' ( EMPLOYEE )
EMPNAMES ASSIGNMENT PI Fname, Lname, Ssn ( FEMALE_EMPS )
EMP_DEPENDENTS ASSIGNMENT EMPNAMES PRODUCT_CARTESIAN DEPENDENT
ACTUAL_DEPENDENTS ASSIGNMENT SIGMA Ssn = Essn ( EMP_DEPENDENTS )
RESULT ASSIGNMENT PI Fname, Lname, Dependent_name ( ACTUAL_DEPENDENTS )

/* Operação Junção */
DEPT_MGR ASSIGNMENT DEPARTMENT JOIN Mgr_ssn = Ssn EMPLOYEE
RESULT ASSIGNMENT PI Dname, Lname, Fname ( DEPT_MGR )

EMP_DEPENDENTS ASSIGNMENT EMPNAMES PRODUCT_CARTESIAN DEPENDENT
ACTUAL_DEPENDENTS ASSIGNMENT SIGMA Ssn = Essn ( EMP_DEPENDENTS )
ACTUAL_DEPENDENTS ASSIGNMENT EMPNAMES JOIN Ssn = Essn DEPENDENT

/* Operação Junção natural */
PROJ_DEPT ASSIGNMENT PROJECT NATURAL_JOIN RHO ( Dname, Dnum, Mgr_ssn, Mgr_start_date ) ( DEPARTMENT )
DEPT ASSIGNMENT RHO ( Dname, Dnum, Mgr_ssn, Mgr_start_date ) ( DEPARTMENT )
PROJ_DEPT ASSIGNMENT PROJECT NATURAL_JOIN DEPT

DEPT_LOCS ASSIGNMENT DEPARTMENT NATURAL_JOIN DEPT_LOCATIONS

/* Operação Divisão */
SMITH ASSIGNMENT SIGMA Fname ='John' AND Lname ='Smith' ( EMPLOYEE )
SMITH_PNOS ASSIGNMENT PI Pno ( WORKS_ON JOIN Essn = Ssn SMITH )

SSN_PNOS ASSIGNMENT PI Essn, Pno ( WORKS_ON )
SSNS ( Ssn ) ASSIGNMENT SSN_PNOS DIVISION SMITH_PNOS
RESULT ASSIGNMENT PI Fname, Lname ( SSNS NATURAL_JOIN EMPLOYEE )

(( PROJECT JOIN Dnum = Dnumber DEPARTMENT ) JOIN Mgr_ssn = Ssn EMPLOYEE ) /* Parei aqui*/

/* Consulta da seção 8.3.5 */
PI Pnumber, Dnum, Lname, Address, Bdate (((SIGMA Plocation ='Stafford' ( PROJECT )) JOIN Dnum = Dnumber ( DEPARTMENT )) JOIN Mgr_ssn = Ssn ( EMPLOYEE ))

/* Operação Projeção generalizada */
REPORT ASSIGNMENT RHO ( Ssn, Net_salary, Bonus, Tax ) (PI Ssn, Salary - Deduction , 2000 * Years_service , 0.25 * Salary ( EMPLOYEE ))

/* Operações de agregação e agrupamento */
RHO R( Dno, No_of_employees, Average_sal ) ( Dno FSCRIPT COUNT Ssn, AVERAGE Salary ( EMPLOYEE ))
Dno FSCRIPT COUNT Ssn, AVERAGE Salary (EMPLOYEE)
FSCRIPT COUNT Ssn, AVERAGE Salary (EMPLOYEE)

/* Operação de fechamento recursivo Seção 8.4.3 */
BORG_SSN ASSIGNMENT PI Ssn (SIGMA Fname ='James' AND Lname ='Borg' ( EMPLOYEE ))
SUPERVISION ( Ssn1 , Ssn2 ) ASSIGNMENT PI Ssn , Super_ssn ( EMPLOYEE )
RESULT1 ( Ssn ) ASSIGNMENT PI Ssn1 ( SUPERVISION JOIN Ssn2 = Ssn BORG_SSN)
RESULT2 ( Ssn ) ASSIGNMENT PI Ssn1 ( SUPERVISION JOIN Ssn2 = Ssn RESULT1 )
RESULT ASSIGNMENT RESULT2 UNION RESULT1

/* Operação Junção externa */
TEMP ASSIGNMENT ( EMPLOYEE LEFT_OUTER_JOIN Ssn = Mgr_ssn DEPARTMENT )
RESULT ASSIGNMENT PI Fname , Minit , Lname , Dname ( TEMP )


/* Outros exemplos de consultas*/

/* Query 1*/
RESEARCH_DEPT ASSIGNMENT SIGMA Dname ='Research' ( DEPARTMENT )
RESEARCH_EMPS ASSIGNMENT ( RESEARCH_DEPT JOIN Dnumber = Dno EMPLOYEE )
RESULT ASSIGNMENT PI Fname , Lname , Address ( RESEARCH_EMPS )

PI Fname , Lname , Address (SIGMA Dname ='Research' ( DEPARTMENT JOIN Dnumber=Dno ( EMPLOYEE )))

/* Query 2*/
STAFFORD_PROJS ASSIGNMENT SIGMA Plocation ='Stafford' ( PROJECT )
CONTR_DEPTS ASSIGNMENT ( STAFFORD_PROJS JOIN Dnum = Dnumber DEPARTMENT )
PROJ_DEPT_MGRS ASSIGNMENT ( CONTR_DEPTS JOIN Mgr_ssn = SsnE MPLOYEE )
RESULT ASSIGNMENT PI Pnumber, Dnum, Lname, Address, Bdate ( PROJ_DEPT_MGRS )

/* Query 3*/
DEPT5_PROJS ASSIGNMENT RHO ( Pno ) (PI Pnumber (SIGMA Dnum = 5 ( PROJECT )))
EMP_PROJ ASSIGNMENT RHO ( Ssn , Pno ) (PI Essn , Pno ( WORKS_ON ))
RESULT_EMP_SSNS ASSIGNMENT EMP_PROJ DIVISION DEPT5_PROJS
RESULT ASSIGNMENT PI Lname , Fname ( RESULT_EMP_SSNS NATURAL_JOIN EMPLOYEE )

/* Query 4*/
SMITHS ( Essn ) ASSIGNMENT PI Ssn (SIGMA Lname ='Smith' ( EMPLOYEE ))
SMITH_WORKER_PROJS ASSIGNMENT PI Pno ( WORKS_ON NATURAL_JOIN SMITHS )
MGRS ASSIGNMENT PI Lname , Dnumber ( EMPLOYEE JOIN Ssn = Mgr_ssn DEPARTMENT )
SMITH_MANAGED_DEPTS ( Dnum ) ASSIGNMENT PI Dnumber (SIGMA Lname ='Smith' ( MGRS ))
SMITH_MGR_PROJS ( Pno ) ASSIGNMENT PI Pnumber ( SMITH_MANAGED_DEPTS NATURAL_JOIN PROJECT )
RESULT ASSIGNMENT ( SMITH_WORKER_PROJS UNION SMITH_MGR_PROJS )

PI Pno ( WORKS_ON JOIN Essn=Ssn (PI Ssn (SIGMA Lname ='Smith' ( EMPLOYEE ))) UNION PI Pno ((PI Dnumber (SIGMA Lname ='Smith' (PI Lname , Dnumber ( EMPLOYEE ))) JOIN Ssn=Mgr_ssn DEPARTMENT )) JOIN Dnum_ber = Dnum PROJECT) /*Resolvido*/

/* Query 5*/
T1( Ssn, No_of_dependents ) ASSIGNMENT Essn FSCRIPT COUNT Dependent_name ( DEPENDENT )
T2 ASSIGNMENT SIGMA No_of_dependents>2 (T1)
RESULT ASSIGNMENT PI Lname , Fname (T2 NATURAL_JOIN EMPLOYEE )

/* Query 6*/
ALL_EMPS ASSIGNMENT PI Ssn ( EMPLOYEE )
EMPS_WITH_DEPS ( Ssn ) ASSIGNMENT PI Essn ( DEPENDENT )
EMPS_WITHOUT_DEPS ASSIGNMENT ( ALL_EMPS SUBTRACTION EMPS_WITH_DEPS )
RESULT ASSIGNMENT PI Lname , Fname ( EMPS_WITHOUT_DEPS NATURAL_JOIN EMPLOYEE )
 
PI Lname , Fname ((PI Ssn ( EMPLOYEE ) SUBTRACTION RHO Ssn (PI Essn ( DEPENDENT ))) NATURAL_JOIN EMPLOYEE ) /*Resolvido*/

/* Query 7*/
MGRS ( Ssn ) ASSIGNMENT PI Mgr_ssn ( DEPARTMENT )
EMPS_WITH_DEPS ( Ssn ) ASSIGNMENT PI Essn ( DEPENDENT )
MGRS_WITH_DEPS ASSIGNMENT ( MGRS INTERSECTION EMPS_WITH_DEPS )
RESULT ASSIGNMENT PI Lname , Fname ( MGRS_WITH_DEPS NATURAL_JOIN EMPLOYEE )
